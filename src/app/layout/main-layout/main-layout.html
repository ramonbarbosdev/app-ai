<div class="h-screen w-screen flex flex-col bg-[#020617] overflow-hidden">

  <app-chat-header [title]="chat.activeConversation()?.title ?? ''"
    (commandPalette)="chat.openPalette()"></app-chat-header>

  <div class="flex-1 flex overflow-hidden relative">

    <div class="flex-1 flex flex-col min-w-0 h-full">

      <app-chat-canvas [conversation]="chat.activeConversation()" [isTyping]="chat.isTyping()"></app-chat-canvas>
      <app-chat-input [isTyping]="chat.isTyping()" (send)="chat.sendMessage($event)"></app-chat-input>

    </div>

    <button (click)="chat.toggleContext()"
      class="absolute right-2 top-2 p-1.5 rounded-lg text-white/50 hover:text-white hover:bg-white/10 transition hidden lg:flex">
      <span *ngIf="chat.contextOpen()">⮜</span>
      <span *ngIf="!chat.contextOpen()">⮞</span>
    </button>

    <app-context-panel [conversation]="chat.activeConversation()" [isOpen]="chat.contextOpen()"
      (close)="chat.toggleContext()"></app-context-panel>

  </div>

  <app-conversation-dock [conversations]="chat.conversations()" [activeId]="chat.activeConversationId() ?? ''"
    (select)="chat.setActiveConversation($event)" (create)="chat.createConversation()"></app-conversation-dock>

  <app-command-palette [isOpen]="chat.paletteOpen()" [conversations]="chat.conversations()"
    (close)="chat.closePalette()" (selectConversation)="chat.setActiveConversation($event)"></app-command-palette>

</div>